# Policy

Advanced policy for golang application.

![](./docs/images.png)

Language:
[English](./README.md) |
[‡πÑ‡∏ó‡∏¢](./README_th.md)

![](https://img.shields.io/badge/build-passing-brightgreen)
![](https://img.shields.io/badge/coverage-100%25-brightgreen)
![](https://img.shields.io/badge/license-MIT-blue)

# Policy Syntax (version 1)

**‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô**

- 1 user ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 policies

## (1) Policy

- Policy ‡∏Ñ‡∏∑‡∏≠ fine-grained access control

### ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Policy

```json
{
    "Version": 1,
    "PolicyID": "501228f3-f7f3-4ef1-8bc9-9fb73347f518",
    "Statements": []
}
```

**‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢**

- üìÑ `Version`
- üìÑ `PolicyID`
- üìÇ `Statements`

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢**

- **`Version`** ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≤‡∏°‡∏™‡πÄ‡∏õ‡∏Ñ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏î
    - ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏™‡πÄ‡∏õ‡∏Ñ‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ Version ‡∏Ñ‡∏∑‡∏≠ `1`
- **`PolicyID`** ‡∏Ñ‡∏∑‡∏≠ ‡∏£‡∏´‡∏±‡∏™‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á Policy ‡∏ô‡∏µ‡πâ
    - ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ ‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ
- **`Statements`** ‡∏Ñ‡∏∑‡∏≠ ‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
    - 1 Policy ‡∏°‡∏µ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢ Statements (‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î)

## (2) Statements

- ‡∏Ñ‡∏∑‡∏≠ ‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
- ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Statement

### ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Statement

```json
{
    "Effect": "Allow | Deny",
    "Resource": "res:::resource-key",
    "Actions": [],
    "Conditions": {
        "AtLeastOne": {},
        "MustHaveAll": {}
    }
}
```

**‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢**

- üìÑ `Effect`
    - ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£ "‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï" ‡∏´‡∏£‡∏∑‡∏≠ "‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï"
    - `Allow` ‡∏Ñ‡∏∑‡∏≠ "‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï"
    - `Deny` ‡∏Ñ‡∏∑‡∏≠ "‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï"
- üìÑ `Resource`
    - ‡∏£‡∏∞‡∏ö‡∏∏ Statement ‡∏ô‡∏µ‡πâ ‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î Resource ‡πÉ‡∏î
    - ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ Statement ‡∏à‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà 1 Resource
    - Resource ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ `res:::`
- üìÇ `Actions`
    - ‡∏£‡∏∞‡∏ö‡∏∏ Actions ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏Å‡∏±‡∏ö Resource ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
    - ‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ Statement ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢ Actions, ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô Resource ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
    - ‡πÅ‡∏ï‡πà‡∏•‡∏∞ Action ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ `act:::`
- üìÑ `Conditions`
    - ‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Ç‡∏≠‡∏á Statement ‡∏ô‡∏µ‡πâ
    - ‡∏°‡∏µ 2 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡∏Ñ‡∏∑‡∏≠
        - `AtLeastOne`
        - `MustHaveAll`

## (3) Conditions

- Conditions ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ï‡πâ Quantifier Conditions ‡πÄ‡∏™‡∏°‡∏≠
- Quantifier Conditions ‡∏Ñ‡∏∑‡∏≠ ‡∏ï‡∏±‡∏ß‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏° Conditions
- Quantifier Conditions ‡∏°‡∏µ 2 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
    - `AtLeastOne` (‚àÉ)
    - `MustHaveAll` (‚àÄ)

### Quantifier Conditions

- `AtLeastOne`
    - ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏°‡∏∑‡πà‡∏≠ : ‡∏°‡∏µ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á
- `MustHaveAll`
    - ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÄ‡∏°‡∏∑‡πà‡∏≠ : ‡∏ó‡∏∏‡∏Å‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á

### ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Conditions

```json
{
    "Conditions": {
        "{Quantifier}": {
            "{ValueRefKey}": {
                "{CompareOperator}": ExpectedValue
            }
        }
    }
}
```

### Value Ref Key

- Value Ref Key ‡∏Ñ‡∏∑‡∏≠ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏≠‡πâ‡∏≤‡∏á‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≤‡∏á ‡πÜ ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤ Condition

**‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö**

```txt
{type}:::subkey1:subkey2:subkeyN
```

- ‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢
    - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏µ subkey ‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ `:` (colon) ‡∏Ñ‡∏±‡πà‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞ level
    - ‡πÉ‡∏ä‡πâ lower case (`a-z0-9`) ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
    - ‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡∏î‡πâ‡∏ß‡∏¢ Underscore (`_`) ‡πÄ‡∏ä‡πà‡∏ô `employee_uuid`
- `{type}` ‡∏°‡∏µ 2 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡∏Ñ‡∏∑‡∏≠
    - **Resource Properties**
        - ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏ñ‡∏∂‡∏á Properties ‡∏Ç‡∏≠‡∏á Resource
        - ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ `prop:::`
    - **System**
        - ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å System ‡∏Ç‡∏≠‡∏á server
        - ‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ `sys:::`

### Compare Operator

- ‡∏Ñ‡∏∑‡∏≠ ‡∏ï‡∏±‡∏ß‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á `{ValueRefKey}` ‡πÅ‡∏•‡∏∞ `{ExpectedValue}`

#### Type ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÑ‡∏î‡πâ

- (1) Primitive Type
    - `String`
    - `Integer`
    - `Float`
    - `Boolean`
- (2) System Type
    - `Date & Time`
- (3) User Property Type
    - `UserProp`

##### (1) Primitive Type

- {T} ‡∏Ñ‡∏∑‡∏≠ Type: String, Integer, Float, Boolean
- ‡∏°‡∏µ 2 Operators ‡∏Ñ‡∏∑‡∏≠ `{T}Equal` ‡πÅ‡∏•‡∏∞ `{T}In`

###### `{T}Equal`

- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Type ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Value ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô
- Operator ‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
    - **`StringEqual`**
    - **`IntegerEqual`**
    - **`FloatEqual`**
    - **`BooleanEqual`**

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

```json
{
    "prop:::employee:organization_uuid": {
        "StringEqual": "501228f3f7f34ef18bc99fb73347f518"
    }
}
```

‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:
‡∏Ñ‡πà‡∏≤ property `"prop:::employee:organization_uuid"`  ‡∏Ç‡∏≠‡∏á Resource ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• `string`
‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô `"501228f3f7f34ef18bc99fb73347f518"`

###### `{T}In`

- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Type ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
- ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Value ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏î‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô Array ‡∏Ç‡∏≠‡∏á `{ExpectedValue}`
- Operator ‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ
    - **`StringIn`**
    - **`IntegerIn`**
    - **`FloatIn

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

```json
{
    "prop:::employee:organization_uuid": {
        "StringIn": [
            "501228f3f7f34ef18bc99fb73347f518",
            "d23b9e25b0f0405686f0c104007d1955",
            "e45b9e25b0f0405686f0c104007d1904",
            "c78b9e25b0f0405686f0c104007d1967"
        ]
    }
}
```

‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢:
‡∏Ñ‡πà‡∏≤ property `"prop:::employee:organization_uuid"`  ‡∏Ç‡∏≠‡∏á Resource ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• `string`
‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡πÉ‡∏î‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÉ‡∏ô Array ‡∏ô‡∏µ‡πâ

##### (2) System Type

‚ö†Ô∏è ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ implement

**‡∏´‡∏°‡∏ß‡∏î: ‡πÄ‡∏ß‡∏•‡∏≤**

- ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ `{ValueRefKey}` ‡πÄ‡∏õ‡πá‡∏ô `"sys:::time:now"`
- ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô `{ExpectedValue}` ‡πÄ‡∏õ‡πá‡∏ô format : `RFC3339`
- {T} ‡∏Ñ‡∏∑‡∏≠ Type: Time, Date, DateTime
- ‡∏°‡∏µ 1 Operators ‡∏Ñ‡∏∑‡∏≠ `{T}Range`

Operator ‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

- `TimeRange`
- `DateRange`
- `DateTimeRange`

###### `TimeRange`

```json
{
    "sys:::time:now": {
        "TimeRange": {
            "From": "15:04:05Z",
            "To": "15:04:05Z"
        }
    }
}
```

###### `DateRange`

```json
{
    "sys:::time:now": {
        "DateRange": {
            "From": "2023-01-01",
            "To": "2023-01-31"
        }
    }
}
```

###### `DateTimeRange`

```json
{
    "sys:::now:time": {
        "DateTimeRange": {
            "From": "2006-01-02T15:04:05Z",
            "To": "2006-01-02T15:04:05Z"
        }
    }
}
```

##### (3) User Property Type

- ‡∏Ñ‡∏∑‡∏≠ ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Resource's property ‡∏Å‡∏±‡∏ö User's property

Operator ‡∏°‡∏µ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

- `UserPropEqual`

###### `UserPropEqual`

- `{ValueRefKey}`
    - ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô property ‡∏Ç‡∏≠‡∏á Resource ‡πÄ‡∏™‡∏°‡∏≠
    - ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ `prop:::` (‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏≠‡πâ‡∏≤‡∏á‡∏ñ‡∏∂‡∏á property ‡∏Ç‡∏≠‡∏á resource)
- `{ExpectedValue}`
    - ‡∏Ñ‡∏∑‡∏≠ property ‡∏Ç‡∏≠‡∏á user
    - ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ `user:::` ‡πÄ‡∏™‡∏°‡∏≠
- User Property ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ type ‡πÄ‡∏õ‡πá‡∏ô string ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á

```json
{
    "prop:::employee:organization_uuid": {
        "UserPropEqual": "user:::employee:organization:organization_uuid"
    }
}
```

‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢

- ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö property ‡∏Ç‡∏≠‡∏á resource ‡∏Å‡∏±‡∏ö property ‡∏Ç‡∏≠‡∏á user ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô type ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (string)
- ‡∏Ñ‡πà‡∏≤ property `"prop:::employee:organization_uuid"`  ‡∏Ç‡∏≠‡∏á Resource ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• `string` ‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö user's
  property `"user:::employee:organization:organization_uuid"` ‡∏Ç‡∏≠‡∏á user ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ user ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ (‡∏ó‡∏≥ Actions) ‡πÉ‡∏î ‡πÜ ‡∏Å‡∏±‡∏ö Resource ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô
organization

## Rule: ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤

**‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô**

- 1 ‡∏Ñ‡∏ô ‡∏°‡∏µ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 1 policy

**‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ**

**Policy A**

```json
{
    "Version": 1,
    "PolicyID": "A",
    "Statements": [
        {
            // Statement A-1
        },
        {
            // Statement A-2
        }
    ]
}
```

**Policy B**

```json
{
    "Version": 1,
    "PolicyID": "B",
    "Statements": [
        {
            // Statement B-1
        },
        {
            // Statement B-2
        },
        {
            // Statement B-3
        }
    ]
}
```

**Policy C**

```json
{
    "Version": 1,
    "PolicyID": "C",
    "Statements": [
        {
            // Statement C-1
        },
        {
            // Statement C-2
        },
        {
            // Statement C-3
        }
    ]
}
```

**1. ‡∏£‡∏ß‡∏° Statement ‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å Policy ‡πÄ‡∏Ç‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô**
‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

```json
[
    {
        // Statement A-1
    },
    {
        // Statement A-2
    },
    {
        // Statement B-1
    },
    {
        // Statement B-2
    },
    {
        // Statement B-3
    },
    {
        // Statement C-1
    },
    {
        // Statement C-2
    },
    {
        // Statement C-3
    }
]
```

**2. Filter Statement ‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏µ‡πà‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (matched) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô**
‡∏™‡∏°‡∏°‡∏∏‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

```json
[
    {
        // Statement A-1
    },
    {
        // Statement B-2
    },
    {
        // Statement C-2
    },
    {
        // Statement C-3
    }
]
```

### Rule: ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

#### Rule 1

- ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ Statement ‡∏ó‡∏µ‡πà matched ‡πÄ‡∏•‡∏¢ (filter ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ 0 statement)
    - return `Deny`

#### Rule 2

- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Statement ‡∏ó‡∏µ‡πà‡∏°‡∏µ `Effect` ‡πÄ‡∏õ‡πá‡∏ô `Deny` ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 statement
    - return `Deny`

#### Rule 3

- ‡∏ñ‡πâ‡∏≤‡∏ó‡∏∏‡∏Å Statements ‡∏ó‡∏µ‡πà‡∏°‡∏µ `Effect` ‡πÄ‡∏õ‡πá‡∏ô `Allow`
    - return `Allow`

### Rule: ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Ç‡∏≠‡∏á statement

#### Rule 4

- ‡∏ñ‡πâ‡∏≤ Statement ‡πÑ‡∏°‡πà‡∏°‡∏µ Condition
    - matched

#### Rule 5

- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Condition ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ Quantifier : `AtLeastOne` ‡∏´‡∏£‡∏∑‡∏≠ `MustHaveAll` ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á
    - ‡πÉ‡∏´‡πâ Quantifier ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ condition ‡∏°‡∏µ‡∏ú‡∏•‡πÄ‡∏õ‡πá‡∏ô `matched`

#### Rule 6

- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ Condition ‡πÉ‡∏´‡πâ AND ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á `AtLeastOne` ‡πÅ‡∏•‡∏∞ `MustHaveAll`

| `AtLeastOne`  | `MustHaveAll` | ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå       |   |
|---------------|---------------|---------------|---|
| `matched`     | `matched`     | `matched`     | ‚≠ê |
| `matched`     | `not matched` | `not matched` |   |
| `not matched` | `matched`     | `not matched` |   |
| `not matched` | `not matched` | `not matched` |   |

‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: `matched` ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö `true`